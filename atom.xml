<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Johnson的博客</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://johnson-hd.github.io/"/>
  <updated>2018-04-16T03:19:56.000Z</updated>
  <id>https://johnson-hd.github.io/</id>
  
  <author>
    <name>Johnson</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>typescript和vue的集成</title>
    <link href="https://johnson-hd.github.io/2018/04/13/typescript/"/>
    <id>https://johnson-hd.github.io/2018/04/13/typescript/</id>
    <published>2018-04-13T14:09:48.000Z</published>
    <updated>2018-04-16T03:19:56.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="创建vue项目"><a href="#创建vue项目" class="headerlink" title="创建vue项目"></a>创建vue项目</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ vue init webpack <span class="string">"vue-typescript-master"</span></span><br><span class="line">$ <span class="built_in">cd</span> vue-typescript-master</span><br><span class="line">$ yarn install</span><br></pre></td></tr></table></figure><h2 id="修改文件后缀"><a href="#修改文件后缀" class="headerlink" title="修改文件后缀"></a>修改文件后缀</h2><p><code>src/main.js</code> =&gt; <code>src/main.ts</code><br><code>src/router/index.js</code> =&gt; <code>src/router/index.ts</code><br><code>src/main.js</code> =&gt; <code>src/main.ts</code></p><h2 id="增加typescript依赖包"><a href="#增加typescript依赖包" class="headerlink" title="增加typescript依赖包"></a>增加typescript依赖包</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ yarn add typescript ts-loader --dev</span><br></pre></td></tr></table></figure><h2 id="webpack配置"><a href="#webpack配置" class="headerlink" title="webpack配置"></a>webpack配置</h2><p>找到 <code>build/webpack.base.conf.js</code><br>修改 <code>entry</code> 为 <code>./src/main.ts</code><br><code>resolve/extensions</code> 增加一项 <code>.ts</code><br><code>rules</code> 增加一项</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="built_in">test</span>: /\.tsx?$/,</span><br><span class="line">  loader: <span class="string">'ts-loader'</span>,</span><br><span class="line">  include: resolve(<span class="string">'src'</span>),</span><br><span class="line">  options: &#123;</span><br><span class="line">    appendTsSuffixTo: [/\.vue$/]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="增加tsconfig-json"><a href="#增加tsconfig-json" class="headerlink" title="增加tsconfig.json"></a>增加tsconfig.json</h2><p>在根目录下创建tsconfig.json，列一下我的内容<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"include"</span>: [</span><br><span class="line">    <span class="string">"src/**/*"</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="string">"exclude"</span>: [</span><br><span class="line">    <span class="string">"node_modules"</span></span><br><span class="line">  ],</span><br><span class="line">  // 编译选项</span><br><span class="line">  <span class="string">"compilerOptions"</span>: &#123;</span><br><span class="line">    <span class="string">"sourceMap"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="string">"strict"</span>: <span class="literal">true</span>,</span><br><span class="line">    // 采用的模块系统</span><br><span class="line">    <span class="string">"module"</span>: <span class="string">"esnext"</span>,</span><br><span class="line">    // 如何处理模块</span><br><span class="line">    <span class="string">"moduleResolution"</span>: <span class="string">"node"</span>,</span><br><span class="line">    // 编译输出目标 ES 版本</span><br><span class="line">    <span class="string">"target"</span>: <span class="string">"es5"</span>,</span><br><span class="line">    // 允许从没有设置默认导出的模块中默认导入</span><br><span class="line">    <span class="string">"allowSyntheticDefaultImports"</span>: <span class="literal">true</span>,</span><br><span class="line">    // 将每个文件作为单独的模块</span><br><span class="line">    <span class="string">"isolatedModules"</span>: <span class="literal">false</span>,</span><br><span class="line">    // 启用装饰器</span><br><span class="line">    <span class="string">"experimentalDecorators"</span>: <span class="literal">true</span>,</span><br><span class="line">    // 允许编译javascript文件</span><br><span class="line">    <span class="string">"allowJs"</span>: <span class="literal">true</span>,</span><br><span class="line">    // 编译过程中需要引入的库文件的列表</span><br><span class="line">    <span class="string">"lib"</span>: [</span><br><span class="line">      <span class="string">"dom"</span>,</span><br><span class="line">      <span class="string">"es2015"</span>,</span><br><span class="line">      <span class="string">"es2015.promise"</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="string">"pretty"</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="增加vue-shims-d-ts"><a href="#增加vue-shims-d-ts" class="headerlink" title="增加vue-shims.d.ts"></a>增加vue-shims.d.ts</h2><p>在 <code>src</code> 目录下增加 <code>vue-shims.d.ts</code> ，内容如下</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">declare</span> module <span class="string">"*.vue"</span> &#123;</span><br><span class="line">  import Vue from <span class="string">"vue"</span></span><br><span class="line">  <span class="built_in">export</span> default Vue</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>解释一下：<code>.d.ts</code> 类型的文件，typescript会自动加载，这里是告诉typescript解析器 <code>*.vue</code> 结尾的文件可以交给 <code>vue</code> 模块来处理，后续我们在引入vue文件的时候，也需要将 <code>.vue</code> 的后缀加上，所以我们现在需要在 <code>main.ts</code> 中修改为 <code>./App.vue</code> 和在 <code>src/router/index.ts</code> 中修改为 <code>@/components/HelloWorld.vue</code></p><h2 id="插件"><a href="#插件" class="headerlink" title="插件"></a>插件</h2><p>至此，我们的vue和typescript已经集成完毕了，如果有问题，可以参照一下 <code>常见问题</code> 项。写typescript我们经常会用到这 <code>vue-class-component</code> 和 <code>vue-property-decorator</code> 这2个插件，用法很简单，自己参照官网即可，别忘记了配置 <code>.babelrc</code> 文件<br><code>vue-class-component</code>: <a href="https://github.com/vuejs/vue-class-component" target="_blank" rel="noopener">https://github.com/vuejs/vue-class-component</a><br><code>vue-property-decorator</code>: <a href="https://github.com/kaorun343/vue-property-decorator" target="_blank" rel="noopener">https://github.com/kaorun343/vue-property-decorator</a></p><h2 id="代码规范"><a href="#代码规范" class="headerlink" title="代码规范"></a>代码规范</h2><p>代码规范使用 <code>tslint</code>，和 <code>eslint</code> 差不多的，需要增加编辑器的配置，和在webpack中增加 <code>tslint-loader</code> 的配置</p><h2 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h2><p>此时执行 <code>npm run start</code> ，可能会报错 <code>Cannot read property &#39;afterCompile&#39; of undefined</code> ，可以看一下这篇文章 <code>https://github.com/TypeStrong/ts-loader/issues/729</code> ，其中有一句话是 <code>Maybe install ts-loader 3.5.0 if you&#39;re not using webpack 4?</code> ，由于默认安装的webpack版本不是4，所以我们需要修改ts-loader的版本</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add ts-loader@3.5 --dev</span><br></pre></td></tr></table></figure><p>此时再执行 <code>npm run start</code> 应该就会正常，或者是正常的typescript语法报错</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;创建vue项目&quot;&gt;&lt;a href=&quot;#创建vue项目&quot; class=&quot;headerlink&quot; title=&quot;创建vue项目&quot;&gt;&lt;/a&gt;创建vue项目&lt;/h2&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;
      
    
    </summary>
    
    
  </entry>
  
</feed>
